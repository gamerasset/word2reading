<view class="container">
  <view class="title-wrapper">
    <image class="logo" src="/assets/logo.png" mode="aspectFit"></image>
    <view class="title">å•è¯ç”Ÿæˆé˜…è¯»</view>
    <view class="subtitle">è¯·è¾“å…¥ 3-5 ä¸ª KET/PET/FCE å•è¯</view>
    <view class="dictionary-status" wx:if="{{!isDictionaryLoaded}}">
      <text class="status-text">è¯å…¸åŠ è½½ä¸­...</text>
    </view>
    <view class="dictionary-status success" wx:if="{{isDictionaryLoaded}}">
      <text class="status-text">âœ“ è¯å…¸å·²å°±ç»ª</text>
    </view>
  </view>

  <view class="form-wrapper">
    <!-- ä½¿ç”¨ wx:for å¾ªç¯æ¸²æŸ“è¾“å…¥æ¡† -->
    <view class="input-group" wx:for="{{inputs}}" wx:key="index">
      <input 
        class="word-input {{item.error ? 'input-error' : ''}}" 
        placeholder="{{item.placeholder}}"
        value="{{item.value}}"
        data-index="{{index}}"
        bindblur="onWordBlur"
      />
      <!-- æ˜¾ç¤ºç¿»è¯‘æˆ–é”™è¯¯ä¿¡æ¯ -->
      <view class="result-text translation" wx:if="{{item.translation}}">{{item.translation}}</view>
      <view class="result-text error" wx:if="{{item.error}}">{{item.error}}</view>
    </view>
  </view>

  <view class="button-wrapper">
    <button 
      class="generate-btn" 
      disabled="{{isButtonDisabled}}"
      loading="{{isLoading}}"
      bindtap="onGenerateClick"
    >
      ç”ŸæˆçŸ­æ–‡
    </button>
  </view>

  <!-- ç»“æœå±•ç¤ºåŒºåŸŸ -->
  <view class="result-container" wx:if="{{showResult}}">
    <!-- æ–‡ç« åŒºåŸŸ -->
    <view class="article-wrapper">
      <view class="article-header">
        <view class="article-title">ğŸ“– é˜…è¯»æ–‡ç« </view>
        <view class="difficulty-badge" wx:if="{{level}}">{{level}}</view>
      </view>
      <view class="article-content">{{article}}</view>
    </view>

    <!-- é—®é¢˜åŒºåŸŸ -->
    <view class="questions-wrapper">
      <view class="questions-title">ğŸ“ é€‰æ‹©é¢˜ ({{questions.length}}é¢˜)</view>
      
      <view class="question-item" wx:for="{{questions}}" wx:key="questionIndex">
        <view class="question-header">
          <text class="question-number">ç¬¬{{index + 1}}é¢˜</text>
          <view class="question-status" wx:if="{{showAnswers}}">
            <text class="status-icon {{item.isCorrect ? 'correct' : 'incorrect'}}">
              {{item.isCorrect ? 'âœ“' : 'âœ—'}}
            </text>
          </view>
        </view>
        
        <view class="question-text">{{item.question}}</view>
        
        <view class="options-wrapper">
          <view 
            class="option-item {{item.userAnswer === option.key ? 'selected' : ''}} {{showAnswers && option.isCorrect ? 'correct-answer' : ''}} {{showAnswers && item.userAnswer === option.key && !item.isCorrect ? 'wrong-answer' : ''}}"
            wx:for="{{item.options}}" 
            wx:for-item="option" 
            wx:key="key"
            data-question-index="{{item.questionIndex}}"
            data-option-key="{{option.key}}"
            bindtap="onAnswerSelect"
          >
            <view class="option-label">{{option.key}}</view>
            <view class="option-text">{{option.text}}</view>
            <view class="option-indicator" wx:if="{{showAnswers && option.isCorrect}}">
              <text class="correct-mark">âœ“</text>
            </view>
          </view>
        </view>
        
        <!-- ç­”æ¡ˆè§£æ -->
        <view class="explanation" wx:if="{{showAnswers}}">
          <view class="explanation-title">ğŸ’¡ è§£æ</view>
          <view class="explanation-text">{{item.explanation}}</view>
        </view>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-buttons">
      <button 
        class="submit-btn" 
        wx:if="{{!showAnswers}}"
        bindtap="onSubmitAnswers"
      >
        æäº¤ç­”æ¡ˆ
      </button>
      
      <view class="result-summary" wx:if="{{showAnswers}}">
        <view class="score-display">
          <text class="score-text">å¾—åˆ†ï¼š{{score}}/{{totalQuestions}}</text>
          <text class="score-percentage">({{scorePercentage}}%)</text>
        </view>
        <button class="restart-btn" bindtap="onRestart">é‡æ–°å¼€å§‹</button>
      </view>
    </view>
  </view>
</view>